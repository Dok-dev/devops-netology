# Домашнее задание к занятию "12.3 Развертывание кластера на собственных серверах, лекция 1"

Поработав с персональным кластером, можно заняться проектами. Вам пришла задача подготовить кластер под новый проект.

## Задание 1: Описать требования к кластеру
Сначала проекту необходимо определить требуемые ресурсы. Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. Опишите, какие ресурсы нужны, если известно:

* база данных должна быть отказоустойчивой (не менее трех копий, master-slave) и потребляет около 4 ГБ ОЗУ в работе;
* кэш должен быть аналогично отказоустойчивый, более трех копий, потребление: 4 ГБ ОЗУ, 1 ядро;
* фронтенд обрабатывает внешние запросы быстро, отдавая статику: не более 50 МБ ОЗУ на каждый экземпляр;
* бекенду требуется больше: порядка 600 МБ ОЗУ и по 1 ядру на копию.

Требования: опишите, сколько нод в кластере и сколько ресурсов (ядра, ОЗУ, диск) нужно для запуска приложения. Расчет вести из необходимости запуска 5 копий фронтенда и 10 копий бекенда, база и кеш.

  
> **Выполнение:**    
>  Расчитаем общее минимальное колличество требуемых ресурсов:
> 
> |  | replicas, шт |  ОЗУ, Мб | Ядра, шт | ОЗУ на сервис, Мб | Ядер на сервис, шт |
> |:---:|:---:|:---:|:---:|:---:|:---:|
> | Frontend pods         | 5  | 50   | 0,2 | 250   | 1  |
> | Backend pods          | 10 | 500  | 1   | 6000  | 10 |
> | DB pods               | 3  | 4096 | 1   | 12288 | 3  |
> | Cache pods            | 4  | 4096 | 1   | 16384 | 4  |
> | Control-node all pods | 1  | 2048 | 2   | 2048  | 2  |
> | Worker-node pods      | 3  | 1024 | 1   | 3072  | 3  |
> | Итого                 |    |      |     | 40042 | 23 |
> 
> Т.к. на control-node рабочие поды из соображений безопасности не разворачивается на потребуется минимум 4 ноды.     
> Учитывая, что кэш требуется как минимум в 4х экземплярах и может быть расположен на всех рабочих нодах, нам понадобятся машины со следующими минимальными характеристиками:
> 
> | Node 1 (Worker) | replicas, шт |  ОЗУ, Мб | Ядра, шт | ОЗУ на сервис, Мб | Ядер на сервис, шт |
> |:---:|:---:|:---:|:---:|:---:|:---:|
> | Frontend pods         | 0  | 50   | 0,2 | 0     | 0 |
> | Backend pods          | 4  | 500  | 1   | 2400  | 4 |
> | DB pods               | 1  | 4096 | 1   | 4096  | 1 |
> | Cache pods            | 2  | 4096 | 1   | 8192  | 2 |
> | Worker-node pods      | 1  | 1024 | 1   | 1024  | 1 |
> | Итого                 |    |      |     | 15712 | 8 |
> 
> | Node 2 (Worker) | replicas, шт |  ОЗУ, Мб | Ядра, шт | ОЗУ на сервис, Мб | Ядер на сервис, шт |
> |:---:|:---:|:---:|:---:|:---:|:---:|
> | Frontend pods         | 3  | 50   | 0,2 | 150   | 0,6 |
> | Backend pods          | 3  | 500  | 1   | 1800  | 3   |
> | DB pods               | 1  | 4096 | 1   | 4096  | 1   |
> | Cache pods            | 2  | 4096 | 1   | 8192  | 2   |
> | Worker-node pods      | 1  | 1024 | 1   | 1024  | 1   |
> | Итого                 |    |      |     | 15262 | 8 (7,6) |
> 
> | Node 3 (Worker) | replicas, шт |  ОЗУ, Мб | Ядра, шт | ОЗУ на сервис, Мб | Ядер на сервис, шт |
> |:---:|:---:|:---:|:---:|:---:|:---:|
> | Frontend pods         | 2  | 50   | 0,2 | 100   | 0,4 |
> | Backend pods          | 3  | 500  | 1   | 1800  | 3   |
> | DB pods               | 1  | 4096 | 1   | 4096  | 1   |
> | Cache pods            | 2  | 4096 | 1   | 8192  | 2   |
> | Worker-node pods      | 1  | 1024 | 1   | 1024  | 1   |
> | Итого                 |    |      |     | 15212 | 8 (7,4) |
>
> | Node 4 (Control) | replicas, шт |  ОЗУ, Мб | Ядра, шт | ОЗУ на сервис, Мб | Ядер на сервис, шт |
> |:---:|:---:|:---:|:---:|:---:|:---:|
> | Control-node all pods | 1  | 2048 | 2   | 2048  | 2 |
> | Итого                 |    |      |     | 2048 | 2 |
> 
> Для расчета требуемого дискового постранства нехватает исходных данных, но можно предположить, что для Control-ноды понядобится порядка 50Гб, а для Worker-нод от 100Гб дискового пространства.

---

